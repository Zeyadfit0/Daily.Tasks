<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Daily Tasks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">

  <style>
    :root {
      --bg: #f4f6fb;
      --card: #ffffff;
      --text: #222;
      --primary: #5b6cff;
      --secondary: #8f9bff;
    }

    body.dark {
      --bg: #0f1220;
      --card: #1b1f3a;
      --text: #f1f1f1;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: var(--bg);
      font-family: 'Segoe UI', Tahoma, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .app {
      width: 100%;
      max-width: 420px;
      background: var(--card);
      border-radius: 24px;
      padding: 24px;
      box-shadow: 0 25px 60px rgba(0,0,0,0.25);
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    h1 {
      margin: 0;
      font-size: 22px;
      color: var(--text);
    }

    .toggle {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      background: var(--primary);
      color: #fff;
    }

    .input-group {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    input {
      flex: 1;
      padding: 14px;
      border-radius: 14px;
      border: none;
      outline: none;
      font-size: 15px;
      background: #eceefe;
    }

    body.dark input {
      background: #2a2f55;
      color: white;
    }

    .add-btn {
      padding: 14px 18px;
      border-radius: 14px;
      border: none;
      cursor: pointer;
      background: var(--primary);
      color: white;
    }

    .task {
      background: rgba(0,0,0,0.05);
      padding: 14px;
      border-radius: 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      color: var(--text);
    }

    body.dark .task {
      background: rgba(255,255,255,0.08);
    }

    .task.done {
      opacity: 0.5;
      text-decoration: line-through;
    }

    .task-actions button {
      border: none;
      border-radius: 8px;
      padding: 6px 10px;
      margin-right: 6px;
      cursor: pointer;
      color: white;
    }

    .done-btn { background: #4CAF50; }
    .delete-btn { background: #e74c3c; }

    .progress-box {
      margin-top: 20px;
    }

    .progress-bar {
      height: 14px;
      background: #ddd;
      border-radius: 10px;
      overflow: hidden;
    }

    .progress {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      margin-top: 8px;
      font-size: 14px;
      color: var(--text);
    }
  </style>
</head>

<body>
  <div class="app">
    <div class="header">
      <h1>ðŸ“… Daily Tasks</h1>
      <button class="toggle" onclick="toggleDark()">ðŸŒ™</button>
    </div>

    <div class="input-group">
      <input id="taskInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ØªØ§Ø³Ùƒ" />
      <button class="add-btn" onclick="addTask()">+</button>
    </div>

    <div id="taskList"></div>

    <div class="progress-box">
      <div class="progress-bar">
        <div class="progress" id="progress"></div>
      </div>
      <div class="progress-text" id="progressText">0% Ø¥Ù†Ø¬Ø§Ø²</div>
    </div>
  </div>

  <script>
    const today = new Date().toDateString();

    let data = JSON.parse(localStorage.getItem('dailyData')) || {
      date: today,
      tasks: []
    };

    if (data.date !== today) {
      data = { date: today, tasks: [] };
      save();
    }

    function save() {
      localStorage.setItem('dailyData', JSON.stringify(data));
      localStorage.setItem('dark', document.body.classList.contains('dark'));
    }

    function render() {
      const list = document.getElementById('taskList');
      list.innerHTML = '';

      data.tasks.forEach((task, i) => {
        const div = document.createElement('div');
        div.className = 'task' + (task.done ? ' done' : '');

        div.innerHTML = `
          <span>${task.text}</span>
          <div class="task-actions">
            <button class="done-btn" onclick="finishTask(${i})">âœ”</button>
            <button class="delete-btn" onclick="deleteTask(${i})">ðŸ—‘</button>
          </div>
        `;

        list.appendChild(div);
      });

      updateProgress();
    }

    function addTask() {
      const input = document.getElementById('taskInput');
      if (!input.value.trim()) return;

      data.tasks.push({ text: input.value, done: false });
      input.value = '';
      save();
      render();
    }

    function finishTask(i) {
      data.tasks[i].done = true;
      save();
      render();
    }

    function deleteTask(i) {
      data.tasks.splice(i, 1);
      save();
      render();
    }

    function updateProgress() {
      const done = data.tasks.filter(t => t.done).length;
      const percent = data.tasks.length
        ? Math.round((done / data.tasks.length) * 100)
        : 0;

      document.getElementById('progress').style.width = percent + '%';
      document.getElementById('progressText').innerText = percent + '% Ø¥Ù†Ø¬Ø§Ø²';
    }

    function toggleDark() {
      document.body.classList.toggle('dark');
      save();
    }

    if (localStorage.getItem('dark') === 'true') {
      document.body.classList.add('dark');
    }

    render();

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js');
    }
  </script>
</body>
</html>